import{n as r}from"./index.177d3c17.js";var l={model:{prop:"visible",event:"visibleChange"},props:{visible:{type:Boolean,default:!1},history:{type:Object},auto:{type:Boolean,default:!0}},data(){return{firstOpen:!1}},computed:{dialogVisible:{get(){return this.visible},set(e){this.$emit("visibleChange",e)}}},methods:{checkAutoOpen(){this.auto&&this.hasHistoryInQuery()&&(this.dialogVisible=!0,this.firstOpen=!0)},handlePopupOpen(){this.addHistory()},handlePopupClose(){!this.autoTriggleClose&&this.hasHistoryInQuery()&&(this.hasOpenRecord?this.$router.go(-1):this.removeHistory(),console.log("\u624B\u52A8\u5173\u95ED\u5F39\u7A97")),this.firstOpen=!1,this.autoTriggleClose=!1,this.hasOpenRecord=!1},hasHistoryInQuery(){if(!this.history)return!1;const{query:e}=this.$route;return Object.keys(this.history).some(s=>!!e[s])},addHistory(){this.hasHistoryInQuery()||(this.$router.push({query:{...this.$route.query,...this.history}}),this.hasOpenRecord=!0,console.log("\u624B\u52A8\u6253\u5F00\u5F39\u7A97"))},removeHistory(){if(!this.history)return;const e={};Object.keys(this.history).forEach(s=>{e[s]=void 0}),this.$router.replace({query:{...this.$route.query,...e}})}},watch:{"$route.query"(){if(!this.history)return;const e=this.hasHistoryInQuery();if(!e&&this.dialogVisible){this.dialogVisible=!1,this.autoTriggleClose=!0,this.$emit("autoClose"),console.log("\u81EA\u52A8\u5173\u95ED\u5F39\u7A97");return}e&&!this.dialogVisible&&(this.dialogVisible=!0,this.hasOpenRecord=!0,this.$emit("autoOpen"),console.log("\u81EA\u52A8\u6253\u5F00\u5F39\u7A97"))},dialogVisible(e){e?this.handlePopupOpen():this.handlePopupClose()}},created(){this.dialogVisible?this.handlePopupOpen():this.checkAutoOpen()}},d=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("el-drawer",e._g(e._b({attrs:{title:e.title,visible:e.dialogVisible,"custom-class":"history-dialog "+(e.firstOpen&&"history-dialog_no-anim")},on:{"update:visible":function(i){e.dialogVisible=i}}},"el-drawer",e.$attrs,!1),e.$listeners),[e._t("default")],2)},b=[];const h={name:"HistoryDrawer",mixins:[l],props:{title:{type:String}}},n={};var p=r(h,d,b,!1,f,null,null,null);function f(e){for(let s in n)this[s]=n[s]}var c=function(){return p.exports}(),y=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("el-dialog",e._g(e._b({attrs:{visible:e.dialogVisible},on:{"update:visible":function(i){e.dialogVisible=i}}},"el-dialog",e.$attrs,!1),e.$listeners),[e._t("title",function(){return[e._v(e._s(e.title))]},{slot:"title"}),e._t("default")],2)},m=[];const g={name:"HistoryDialog",mixins:[l],props:{title:{type:String}}},o={};var $=r(g,y,m,!1,x,null,null,null);function x(e){for(let s in o)this[s]=o[s]}var D=function(){return $.exports}(),H=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("a-drawer",e._g(e._b({attrs:{visible:e.dialogVisible,width:"50%",title:e.title},on:{close:function(i){e.dialogVisible=!1}}},"a-drawer",e.$attrs,!1),e.$listeners),[e._t("default")],2)},k=[];const w={name:"HistoryAntDrawer",mixins:[l],props:{title:{type:String}}},a={};var A=r(w,H,k,!1,O,null,null,null);function O(e){for(let s in a)this[s]=a[s]}var V=function(){return A.exports}(),I=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("a-modal",e._g(e._b({model:{value:e.dialogVisible,callback:function(i){e.dialogVisible=i},expression:"dialogVisible"}},"a-modal",e.$attrs,!1),e.$listeners),[e._t("title",function(){return[e._v(e._s(e.title))]},{slot:"title"}),e._t("default")],2)},S=[];const M={name:"HistoryAntModal",mixins:[l],props:{title:{type:String}}},u={};var E=r(M,I,S,!1,R,null,null,null);function R(e){for(let s in u)this[s]=u[s]}var j=function(){return E.exports}(),C=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",[t("h2",[e._v("Demo")]),t("div",[t("table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{border:"1"}},e._l(e.list,function(i){return t("tr",[t("td",[e._v(e._s(i.id))]),t("td",[e._v(e._s(i.name))]),t("td",[e._v(e._s(i.desc))]),t("td",[t("el-link",{attrs:{type:"primary"},on:{click:function(J){return e.onEdit(i)}}},[e._v("\u8BE6\u60C5")])],1)])}),0)]),t("HistoryDrawer",{attrs:{title:e.curItem.name,history:{id:e.curItem.id},auto:!1},on:{"auto-open":e.initDrawer},model:{value:e.visible,callback:function(i){e.visible=i},expression:"visible"}},[e._v(" id\uFF1A"+e._s(e.curItem.id)+" "),t("br"),t("br"),e._v(" \u59D3\u540D\uFF1A"+e._s(e.curItem.name)+" "),t("br"),t("br"),e._v(" \u8BE6\u60C5\uFF1A"+e._s(e.curItem.desc)+" "),t("br"),t("br"),t("br"),t("br"),t("el-button",{attrs:{type:"primary"},on:{click:e.refresh}},[e._v("\u5237\u65B0\u9875\u9762")]),e._v("\xA0\xA0 "),t("router-link",{attrs:{to:"/A"}},[t("el-button",{attrs:{type:"success"}},[e._v("\u8DF3\u8F6C\u9875\u9762")])],1)],1)],1)},q=[];const F={name:"Demo",components:{HistoryDrawer:c},data(){return{list:[],curItem:{},visible:!1,loading:!1}},computed:{id(){return this.$route.query.id}},methods:{fetchList(){this.loading=!0,setTimeout(()=>{this.loading=!1,this.list=[{id:1,name:"\u5F20\u4E09",desc:"\u6253\u7403\u5F88\u5389\u5BB3"},{id:2,name:"\u674E\u56DB",desc:"\u5531\u6B4C\u5F88\u5389\u5BB3"}],this.initDrawer()},1e3)},initDrawer(){this.id&&(this.curItem=this.list.find(e=>String(e.id)===String(this.id)),this.visible=!0)},onEdit(e){this.curItem=e,this.visible=!0},refresh(){window.location.reload()}},created(){this.fetchList()}},_={};var P=r(F,C,q,!1,Q,"d6aae004",null,null);function Q(e){for(let s in _)this[s]=_[s]}var T=function(){return P.exports}(),B=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",[t("el-button",{attrs:{type:"primary"},on:{click:function(i){e.visible=!e.visible}}},[e._v("\u6253\u5F00\u62BD\u5C49")]),t("el-button",{attrs:{type:"primary"},on:{click:function(i){e.visible2=!e.visible2}}},[e._v("\u6253\u5F00\u5F39\u7A97")]),t("el-button",{attrs:{type:"primary"},on:{click:function(i){e.visible3=!e.visible3}}},[e._v("\u6253\u5F00Ant\u62BD\u5C49")]),t("el-button",{attrs:{type:"primary"},on:{click:function(i){e.visible4=!e.visible4}}},[e._v("\u6253\u5F00Ant\u5F39\u7A97")]),t("HistoryDrawer",{attrs:{title:"\u62BD\u5C49",history:{drawer:!0}},model:{value:e.visible,callback:function(i){e.visible=i},expression:"visible"}},[e._v(" El\u62BD\u5C49 ")]),t("HistoryDialog",{attrs:{title:"\u5F39\u7A97",history:{dialog:!0}},model:{value:e.visible2,callback:function(i){e.visible2=i},expression:"visible2"}},[e._v(" El\u5F39\u7A97 ")]),t("HistoryAntDrawer",{attrs:{title:"\u62BD\u5C49",history:{antDrawer:!0}},model:{value:e.visible3,callback:function(i){e.visible3=i},expression:"visible3"}},[e._v(" Ant\u62BD\u5C49 ")]),t("HistoryAntModal",{attrs:{title:"\u5F39\u7A97",history:{antModal:!0}},model:{value:e.visible4,callback:function(i){e.visible4=i},expression:"visible4"}},[e._v(" Ant\u5F39\u7A97 ")]),t("el-divider"),t("el-button",{attrs:{type:"primary"},on:{click:function(i){e.visible5=!e.visible5}}},[e._v("\u591A\u5C42\u62BD\u5C49")]),e._v(" \xA0 \xA0 "),t("el-link",[t("a",{attrs:{href:"#/?nestDrawer1=true&nestDrawer2=true&nestDialog1=true",target:"_blank"}},[e._v("\u6253\u5F00\u94FE\u63A5\uFF08/?nestDrawer1=true&nestDrawer2=true&nestDialog1=true\uFF09")])]),t("HistoryDrawer",{attrs:{"append-to-body":"",title:"\u5185\u5BB9\u9875",history:{nestDrawer1:!0}},model:{value:e.visible5,callback:function(i){e.visible5=i},expression:"visible5"}},[e._v(" \u5DF4\u5C71\u695A\u6C34\u51C4\u51C9\u5730\uFF0C\u4E8C\u5341\u4E09\u5E74\u5F03\u7F6E\u8EAB\u3002"),t("br"),t("br"),e._v(" \u6000\u65E7\u7A7A\u541F\u95FB\u7B1B\u8D4B\uFF0C\u5230\u4E61\u7FFB\u4F3C\u70C2\u67EF\u4EBA\u3002"),t("br"),t("br"),e._v(" \u6C89\u821F\u4FA7\u7554\u5343\u5E06\u8FC7\uFF0C\u75C5\u6811\u524D\u5934\u4E07\u6728\u6625\u3002"),t("br"),t("br"),e._v(" \u4ECA\u65E5\u542C\u541B\u6B4C\u4E00\u66F2\uFF0C\u6682\u51ED\u676F\u9152\u957F\u7CBE\u795E\u3002"),t("br"),t("br"),t("el-button",{on:{click:function(i){e.visible6=!e.visible6}}},[e._v("\u4E2A\u4EBA\u4FE1\u606F")]),e._v("\xA0\xA0 "),t("router-link",{attrs:{to:"/A"}},[t("el-button",{attrs:{type:"success"}},[e._v("\u8DF3\u8F6C\u9875\u9762")])],1),t("HistoryDrawer",{attrs:{"append-to-body":"",title:"\u4E2A\u4EBA\u4FE1\u606F",history:{nestDrawer2:!0}},model:{value:e.visible6,callback:function(i){e.visible6=i},expression:"visible6"}},[e._v(" \u6027\u522B\uFF1A\u7537"),t("br"),t("br"),e._v(" \u7231\u597D\uFF1A\u5973"),t("br"),t("br"),t("el-button",{on:{click:function(i){e.visible7=!e.visible7}}},[e._v("\u5174\u8DA3\u7231\u597D")]),e._v("\xA0\xA0 "),t("router-link",{attrs:{to:"/A"}},[t("el-button",{attrs:{type:"success"}},[e._v("\u8DF3\u8F6C\u9875\u9762")])],1),t("HistoryDialog",{attrs:{"append-to-body":"",title:"\u5174\u8DA3\u7231\u597D",history:{nestDialog1:!0}},model:{value:e.visible7,callback:function(i){e.visible7=i},expression:"visible7"}},[e._v(" \u5531\u3001\u8DF3\u3001rap\u3001\u7BEE\u7403"),t("br"),t("br"),t("router-link",{attrs:{to:"/A"}},[t("el-button",{attrs:{type:"success"}},[e._v("\u8DF3\u8F6C\u9875\u9762")])],1)],1)],1)],1),t("el-divider"),t("Demo")],1)},L=[];const z={components:{HistoryDrawer:c,HistoryDialog:D,HistoryAntDrawer:V,HistoryAntModal:j,Demo:T},data(){return{visible:!1,visible2:!1,visible3:!1,visible4:!1,visible5:!1,visible6:!1,visible7:!1,visible8:!1}}},v={};var N=r(z,B,L,!1,G,"26f59859",null,null);function G(e){for(let s in v)this[s]=v[s]}var U=function(){return N.exports}();export{U as default};
